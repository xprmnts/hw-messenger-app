(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{146:function(e,t,n){},207:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(11),s=n.n(c),o=(n(146),n(250)),i=n(50),u=n(9),l=n(78),d=n(118),f=n.n(d),b=n(119),j=n(35),m="GET_USER",p="SET_FETCHING_STATUS",h=function(e){return{type:m,user:e}},g=function(e){return{type:p,isFetching:e}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return t.user;case p:return Object(j.a)(Object(j.a)({},e),{},{isFetching:t.isFetching});default:return e}},O=n(77),v=function(e,t){var n=t.message,r=t.sender;if(null!==r){var a={id:n.conversationId,otherUser:r,messages:[n]};return a.latestMessageText=n.text,[a].concat(Object(O.a)(e))}return e.map((function(e){if(e.id===n.conversationId){var t=Object(j.a)({},e);return t.messages.push(n),t.latestMessageText=n.text,t}return e}))},w=function(e,t){return e.map((function(e){if(t.includes(e.otherUser.id)){var n=Object(j.a)({},e);return n.otherUser.online=!0,n}return e}))},C=function(e,t){return e.map((function(e){if(e.otherUser.id===t){var n=Object(j.a)({},e);return n.otherUser.online=!0,n}return e}))},y=function(e,t){return e.map((function(e){if(e.otherUser.id===t){var n=Object(j.a)({},e);return n.otherUser.online=!1,n}return e}))},S=function(e,t){var n={};e.forEach((function(e){n[e.otherUser.id]=!0}));var r=Object(O.a)(e);return t.forEach((function(e){if(!n[e.id]){var t={otherUser:e,messages:[]};r.push(t)}})),r},k=function(e,t,n){return e.map((function(e){if(e.otherUser.id===t){var r=Object(j.a)({},e);return r.id=n.conversationId,r.messages.push(n),r.latestMessageText=n.text,r}return e}))},E=function(e,t){return e.map((function(e){if(e.id===t[0].conversationId){var n=Object(j.a)({},e);return n.messages=Object(O.a)(t),n}return e}))},F="GET_CONVERSATIONS",N="SET_MESSAGE",I="ADD_ONLINE_USER",T="SET_ONLINE_USERS",U="REMOVE_OFFLINE_USER",A="SET_SEARCHED_USERS",D="CLEAR_SEARCHED_USERS",R="ADD_CONVERSATION",W="UPDATE_CONVERSATION",M=function(e,t){return{type:N,payload:{message:e,sender:t||null}}},B=function(e){return{type:W,payload:{messages:e}}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return t.conversations;case N:return v(e,t.payload);case T:return w(e,t.users);case I:return C(e,t.id);case U:return y(e,t.id);case A:return S(e,t.users);case D:return e.filter((function(e){return e.id}));case R:return k(e,t.payload.recipientId,t.payload.newMessage);case W:return E(e,t.payload.messages);default:return e}},P="SET_ACTIVE_CHAT",z=function(e){return{type:P,username:e}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:return t.username;default:return e}},G="CLEAR_ON_LOGOUT",H=Object(l.b)({user:x,conversations:L,activeConversation:_}),V=Object(l.c)((function(e,t){return t.type===G&&(e=void 0),H(e,t)}),Object(l.a)(b.a,f.a)),Z=n(128),q=Object(Z.a)({typography:{fontFamily:"Open Sans, sans-serif",fontSize:14,button:{textTransform:"none",letterSpacing:0,fontWeight:"bold"}},overrides:{MuiInput:{input:{fontWeight:"bold"}},MuiButton:{sizeLarge:{margin:"1rem 3rem",padding:"0.75rem 3rem"}}},palette:{primary:{main:"#3A8DFF"},secondary:{main:"#B0B0B0"}}}),J=n(20),X=n(16),Y=n(8),$=n.n(Y),K=n(17),Q=n(42),ee=n.n(Q),te=n(123),ne=n.n(te)()(window.location.origin,{autoConnect:!1});ne.on("read-messages",(function(e){V.dispatch(B(e))})),ne.on("users",(function(e){V.dispatch(function(e){return{type:T,users:e}}(e))})),ne.on("add-online-user",(function(e){V.dispatch(function(e){return{type:I,id:e}}(e))})),ne.on("remove-offline-user",(function(e){V.dispatch(function(e){return{type:U,id:e}}(e))})),ne.on("new-message",(function(e){V.dispatch(M(e.message,e.sender))}));var re,ae=ne,ce=function(e){return function(){var t=Object(K.a)($.a.mark((function t(n){var r,a;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee.a.post("/auth/register",e);case 3:r=t.sent,a=r.data,n(h(a)),ae.emit("go-online",a.id),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),n(h({error:t.t0.response.data.error||"Server Error"}));case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},se=function(e){return function(){var t=Object(K.a)($.a.mark((function t(n){var r,a;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee.a.post("/auth/login",e);case 3:r=t.sent,a=r.data,n(h(a)),ae.emit("go-online",a.id),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),n(h({error:t.t0.response.data.error||"Server Error"}));case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},oe=function(e){return function(){var t=Object(K.a)($.a.mark((function t(n){return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee.a.delete("/auth/logout");case 3:n(h({})),ae.emit("logout",e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},ie=function(){var e=Object(K.a)($.a.mark((function e(t){var n,r;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.a.post("/api/messages",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(e,t){ae.emit("new-message",{data:e,to:t.recipientId})},le=function(e){return function(){var t=Object(K.a)($.a.mark((function t(n){var r;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ie(e);case 3:r=t.sent,e.conversationId?n(M(r.message)):n((a=e.recipientId,c=r.message,{type:R,payload:{recipientId:a,newMessage:c}})),ue(r,e),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}var a,c}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},de=function(e){return function(){var t=Object(K.a)($.a.mark((function t(n){var r,a;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee.a.get("/api/users/".concat(e));case 3:r=t.sent,a=r.data,n({type:A,users:a}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},fe=n(22),be=n(240),je=n(251),me=n(210),pe=n(238),he=n(132),ge=n.p+"static/media/bg-img.0c5628a9.png";function xe(){return(xe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Oe(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function ve(e,t){var n=e.title,a=e.titleId,c=Oe(e,["title","titleId"]);return r.createElement("svg",xe({width:"67px",height:"67px",viewBox:"0 0 67 67",xmlnsXlink:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},c),n?r.createElement("title",{id:a},n):null,re||(re=r.createElement("g",{id:"chat"},r.createElement("path",{d:"M57.1688 9.66977C50.8366 3.43256 42.4361 0 33.4832 0C24.5302 0 16.1298 3.43256 9.79755 9.66977C-2.44191 21.7256 -3.29187 41.0233 7.68681 54.0419C6.61019 56.1767 4.88194 58.6605 2.31788 59.9023C1.08544 60.5023 0.391302 61.8 0.603792 63.1395C0.816283 64.4791 1.86457 65.5256 3.22451 65.7349C3.86198 65.8326 4.76861 65.9302 5.87356 65.9302C8.83426 65.9302 13.1974 65.2465 17.6597 62.0791C22.632 64.7163 28.0717 66 33.469 66C42.1386 66 50.7232 62.693 57.1829 56.3302C63.5152 50.093 67 41.8186 67 33C67 24.1814 63.501 15.907 57.1688 9.66977ZM54.4631 53.6651C44.901 63.0837 30.0975 64.9535 18.453 58.214C17.688 57.7674 16.7389 57.907 16.1298 58.507C16.0731 58.5349 16.0164 58.5767 15.9739 58.6186C12.1349 61.5488 8.36678 62.1628 5.87356 62.1628L5.85939 62.1628C8.7351 60.0977 10.5483 57.0279 11.6108 54.6419C11.7808 54.2372 11.8091 53.8186 11.71 53.4279C11.6675 53.0512 11.5116 52.6744 11.2425 52.3674C0.872947 40.8279 1.41126 23.2465 12.4891 12.3349C24.0627 0.934884 42.8894 0.934884 54.4489 12.3349C66.0367 23.7349 66.0367 42.2651 54.4631 53.6651Z",transform:"translate(0 0.5)",id:"Shape",fill:"#FFFFFF",stroke:"none"}),r.createElement("path",{d:"M2.5 5C3.88071 5 5 3.88071 5 2.5C5 1.11929 3.88071 0 2.5 0C1.11929 0 0 1.11929 0 2.5C0 3.88071 1.11929 5 2.5 5Z",transform:"translate(31 31.5)",id:"Oval",fill:"#FFFFFF",stroke:"none"}),r.createElement("path",{d:"M2.5 5C3.88071 5 5 3.88071 5 2.5C5 1.11929 3.88071 0 2.5 0C1.11929 0 0 1.11929 0 2.5C0 3.88071 1.11929 5 2.5 5Z",transform:"translate(43 31.5)",id:"Oval",fill:"#FFFFFF",stroke:"none"}),r.createElement("path",{d:"M2.5 5C3.88071 5 5 3.88071 5 2.5C5 1.11929 3.88071 0 2.5 0C1.11929 0 0 1.11929 0 2.5C0 3.88071 1.11929 5 2.5 5Z",transform:"translate(19 31.5)",id:"Oval",fill:"#FFFFFF",stroke:"none"}))))}var we=r.forwardRef(ve),Ce=(n.p,n(2)),ye=Object(pe.a)((function(e){return{imageContainer:{minHeight:"60rem",height:"100vh",backgroundRepeat:"no-repeat",backgroundImage:"url(".concat(ge,")"),backgroundSize:"cover",backgroundPosition:"center"},imageOverlay:{background:"linear-gradient(to bottom, rgba(58, 141, 255, 0.85), rgba(134, 185, 255, 0.85));",minHeight:"60rem",height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},iconRoot:{width:"6rem",height:"6rem",marginTop:"-15rem"},tagLine:{fontSize:"2rem",margin:"4rem 1rem",color:"#FFF"}}})),Se=function(){var e=ye();return Object(Ce.jsx)(be.a,{item:!0,xs:!1,sm:4,className:e.imageContainer,children:Object(Ce.jsx)(je.a,{display:{xs:"none",sm:"block"},children:Object(Ce.jsxs)("div",{className:e.imageOverlay,children:[Object(Ce.jsx)(he.a,{viewBox:"0 0 67 67",className:e.iconRoot,children:Object(Ce.jsx)(we,{})}),Object(Ce.jsxs)(me.a,{align:"center",className:e.tagLine,children:["Converse with anyone",Object(Ce.jsx)("br",{}),"with any language"]})]})})})},ke=n(242),Ee=Object(pe.a)((function(e){return{authPrimaryCTA:{backgroundColor:"#3A8DFF",color:"#FFF",alignSelf:"center"},authSecondaryCTA:{backgroundColor:"#FFF",boxShadow:"4px 4px 5px 0px rgba(0,0,0,0.1)",border:"1px solid rgba(0,0,0,0.05)",color:"#3A8DFF","&:hover":{backgroundColor:"#f7f7f7"}}}})),Fe=function(e){var t=Ee();return Object(Ce.jsx)(ke.a,{type:e.type||"",variant:"contained",size:"large",className:e.type?"".concat(t.authPrimaryCTA):"".concat(t.authSecondaryCTA),onClick:e.onClick,children:e.children})},Ne=Object(pe.a)((function(e){return{secondaryCTAWrapper:{width:"100%"},secondaryCTAContainer:Object(fe.a)({display:"flex",justifyContent:"flex-end",alignItems:"center"},e.breakpoints.down("xs"),{flexDirection:"column",justifyContent:"space-between",alignItems:"center"})}})),Ie=function(e){var t=e.loginState,n=Ne(),r=t?"Already have an account?":"Need to log in?",a=t?"Create Account":"Login";return Object(Ce.jsx)(je.a,{display:e.display,className:n.secondaryCTAWrapper,children:Object(Ce.jsxs)(be.a,{container:!0,item:!0,className:n.secondaryCTAContainer,children:[Object(Ce.jsx)(me.a,{color:"secondary",children:r}),Object(Ce.jsx)(Fe,{onClick:e.onSecondaryCTAClick,children:a})]})})},Te=n(243),Ue=n(252),Ae=n(246),De=Object(pe.a)((function(e){return{formLayout:{flexDirection:"column"},formInputStyling:{margin:"0.75rem 0rem"}}})),Re=function(e){var t=De(),n=e.loginState,r=n?"Login":"Create";return Object(Ce.jsx)("form",{onSubmit:n?e.handleLogin:e.handleRegister,children:Object(Ce.jsxs)(be.a,{container:!0,className:t.formLayout,children:[Object(Ce.jsx)(be.a,{children:Object(Ce.jsx)(Te.a,{fullWidth:!0,className:t.formInputStyling,children:Object(Ce.jsx)(Ue.a,{"aria-label":"username",label:"Username",name:"username",autoComplete:"on",type:"text",required:!0})})}),Object(Ce.jsx)(be.a,{children:!n&&Object(Ce.jsx)(Te.a,{fullWidth:!0,className:t.formInputStyling,children:Object(Ce.jsx)(Ue.a,{label:"E-mail address","aria-label":"e-mail address",type:"email",name:"email",autoComplete:"on",required:!0})})}),Object(Ce.jsx)(be.a,{children:Object(Ce.jsxs)(Te.a,{fullWidth:!0,error:!!e.formErrorMessage.confirmPassword,className:t.formInputStyling,children:[Object(Ce.jsx)(Ue.a,{"aria-label":"password",label:"Password",type:"password",inputProps:{minLength:6},name:"password",autoComplete:"on",required:!0}),Object(Ce.jsx)(Ae.a,{children:e.formErrorMessage.confirmPassword})]})}),Object(Ce.jsx)(be.a,{children:!n&&Object(Ce.jsxs)(Te.a,{fullWidth:!0,className:t.formInputStyling,error:!!e.formErrorMessage.confirmPassword,children:[Object(Ce.jsx)(Ue.a,{label:"Confirm Password","aria-label":"confirm password",type:"password",inputProps:{minLength:6},name:"confirmPassword",autoComplete:"on",required:!0}),Object(Ce.jsx)(Ae.a,{children:e.formErrorMessage.confirmPassword})]})}),Object(Ce.jsx)(Fe,{type:"submit",children:r})]})})},We=Object(pe.a)((function(e){return{authPage:{minHeight:"60rem"},formGrid:{flex:1},formTitle:Object(fe.a)({fontSize:"2rem"},e.breakpoints.down("xs"),{textAlign:"center",fontSize:"1.5rem"}),formWrapper:Object(fe.a)({flex:1,display:"flex",flexDirection:"column",alignItems:"center",margin:"1rem"},e.breakpoints.down("xs"),{justifyContent:"center"}),formMainContainer:Object(fe.a)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center",marginTop:"-15rem",width:"75%",maxWidth:"30rem"},e.breakpoints.down("xs"),{marginTop:"0",flexGrow:"0"})}})),Me=function(){var e=Object(X.g)(),t="/login"===Object(X.h)().pathname,n=We(),a=Object(u.c)((function(e){return e.user})),c=Object(u.b)(),s=Object(r.useState)({}),o=Object(J.a)(s,2),i=o[0],l=o[1],d=t?"Welcome Back!":"Create an account",f=function(){t?e.push("/register"):e.push("/login")},b=function(){var e=Object(K.a)($.a.mark((function e(t){var n,r;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.username.value,r=t.target.password.value,e.next=5,c(se({username:n,password:r}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(K.a)($.a.mark((function e(t){var n,r,a,s;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.target.username.value,r=t.target.email.value,a=t.target.password.value,s=t.target.confirmPassword.value,a===s){e.next=8;break}return l({confirmPassword:"Passwords must match"}),e.abrupt("return");case 8:return e.next=10,c(ce({username:n,email:r,password:a}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.id?Object(Ce.jsx)(X.a,{to:"/home"}):Object(Ce.jsxs)(be.a,{container:!0,component:"main",className:n.authPage,children:[Object(Ce.jsx)(Se,{}),Object(Ce.jsx)(be.a,{item:!0,container:!0,xs:12,className:n.formGrid,justify:"center",children:Object(Ce.jsxs)(je.a,{className:n.formWrapper,children:[Object(Ce.jsx)(Ie,{loginState:t,onSecondaryCTAClick:f,display:{xs:"none",sm:"block"}}),Object(Ce.jsxs)(je.a,{className:n.formMainContainer,children:[Object(Ce.jsx)(me.a,{className:n.formTitle,children:d}),Object(Ce.jsx)(Re,{formErrorMessage:i,setFormErrorMessage:l,loginState:t,handleRegister:j,handleLogin:b})]}),Object(Ce.jsx)(Ie,{display:{xs:"block",sm:"none"},loginState:t,onSecondaryCTAClick:f})]})})]})},Be=n(249),Le=n(4),Pe=Object(pe.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",marginLeft:20,flexGrow:1},wrapper:{flexGrow:1},username:{fontWeight:"bold",letterSpacing:-.2},previewText:{fontSize:"0.75rem",color:"#9CADC8",letterSpacing:-.17,flexBasis:"70%",maxWidth:"15rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},previewTextHighlighted:{fontWeight:"bold",color:"#000"},notification:{minHeight:"1.25rem",minWidth:"1.25rem",backgroundColor:"#3F92FF",margin:"auto 1rem",padding:"0.1rem 0.3rem",color:"white",fontSize:"0.65rem",letterSpacing:-.5,fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:10,alignSelf:"flex-end"},latestMessageWrapper:{display:"flex",justifyContent:"space-between"}}})),ze=function(e){var t=Pe(),n=Object(u.c)((function(e){return e.activeConversation})),r=e.conversation,a=e.unreadMessages,c=r.latestMessageText,s=r.otherUser,o=a.length&&n!==s.username;return Object(Ce.jsx)(je.a,{className:t.root,children:Object(Ce.jsxs)(je.a,{className:t.wrapper,children:[Object(Ce.jsx)(me.a,{className:t.username,children:s.username}),Object(Ce.jsxs)(je.a,{className:t.latestMessageWrapper,children:[Object(Ce.jsx)(me.a,{className:Object(Le.a)(t.previewText,o&&t.previewTextHighlighted),children:c}),a.length>0&&n!==s.username&&Object(Ce.jsx)(me.a,{className:t.notification,children:a.length>100?"100+":a.length})]})]})})},_e=n(129),Ge=n(255),He=n(76),Ve=n.n(He),Ze=Object(pe.a)((function(){return{root:{height:44,marginTop:23,marginLeft:6,display:"flex",alignItems:"center"},subContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",flexGrow:1},username:{letterSpacing:-.23,fontSize:16,fontWeight:"bold",marginLeft:17},menuButton:{minWidth:"1rem",padding:0},ellipsis:{color:"#95A7C4",opacity:.5}}})),qe=function(){var e=Object(u.c)((function(e){return e.user}))||{},t=Ze(),n=Object(r.useState)(!1),a=Object(J.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(!1),i=Object(J.a)(o,2),l=i[0],d=i[1],f=Object(u.b)(),b=Object(X.g)(),j=function(){var t=Object(K.a)($.a.mark((function t(n){return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,f(oe(e.id));case 3:f({type:G}),b.push("/login");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(Ce.jsxs)(je.a,{className:t.root,children:[Object(Ce.jsx)(it,{photoUrl:e.photoUrl,online:!0}),Object(Ce.jsxs)(je.a,{className:t.subContainer,children:[Object(Ce.jsx)(me.a,{className:t.username,children:e.username}),Object(Ce.jsx)(ke.a,{className:t.menuButton,onClick:function(e){d(e.currentTarget),s(!0)},children:Object(Ce.jsx)(Ve.a,{className:t.ellipsis})}),Object(Ce.jsx)(_e.a,{anchorEl:l,open:c,onClose:function(){s((function(e){return!e}))},children:Object(Ce.jsx)(Ge.a,{onClick:j,children:"Logout"})})]})]})},Je=n(244),Xe=n(247),Ye=n(125),$e=n.n(Ye),Ke=Object(pe.a)((function(e){return{filledInput:{height:50,background:"#E9EEF9",borderRadius:5,fontSize:13,fontWeight:"bold",color:"#99A9C4",letterSpacing:0,display:"flex",justifyContent:"center",marginBottom:20},input:{"&::placeholder":{color:"#ADC0DE",opacity:1}}}})),Qe=function(e){var t=Ke();return Object(Ce.jsx)("form",{onSubmit:function(e){e.preventDefault()},children:Object(Ce.jsx)(Te.a,{fullWidth:!0,hiddenLabel:!0,children:Object(Ce.jsx)(Je.a,{name:"search",onChange:e.handleChange,classes:{root:t.filledInput,input:t.input},disableUnderline:!0,placeholder:"Search",startAdornment:Object(Ce.jsx)(Xe.a,{position:"start",children:Object(Ce.jsx)($e.a,{})})})})})},et=Object(pe.a)((function(e){var t;return{root:(t={paddingLeft:21,paddingRight:21,flexGrow:1},Object(fe.a)(t,e.breakpoints.down("sm"),{width:"100%"}),Object(fe.a)(t,e.breakpoints.up("md"),{width:"30%"}),t),title:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginTop:32,marginBottom:15}}})),tt=function(e){var t=et(),n=Object(u.c)((function(e){return e.conversations}))||[],r=e.handleChange,a=e.searchTerm;return Object(Ce.jsxs)(je.a,{className:t.root,children:[Object(Ce.jsx)(qe,{}),Object(Ce.jsx)(me.a,{className:t.title,children:"Chats"}),Object(Ce.jsx)(Qe,{handleChange:r}),n.filter((function(e){return e.otherUser.username.includes(a)})).map((function(e){return Object(Ce.jsx)(at,{conversation:e},e.otherUser.username)}))]})},nt=function(){var e=Object(r.useState)(""),t=Object(J.a)(e,2),n=t[0],a=t[1],c=Object(u.b)(),s=function(){var e=Object(K.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.target.value){e.next=4;break}return c({type:D}),a(""),e.abrupt("return");case 4:if(!n.includes(t.target.value)){e.next=7;break}return a(t.target.value),e.abrupt("return");case 7:return e.next=9,c(de(t.target.value));case 9:a(t.target.value);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(Ce.jsx)(tt,{handleChange:s,searchTerm:n})},rt=Object(pe.a)((function(){return{root:{borderRadius:8,height:80,boxShadow:"0 2px 10px 0 rgba(88,133,196,0.05)",marginBottom:10,display:"flex",alignItems:"center","&:hover":{cursor:"grab"}}}})),at=function(e){var t=Object(r.useState)(0),n=Object(J.a)(t,2),a=n[0],c=n[1],s=rt(),o=Object(u.c)((function(e){return e.user.id})),i=e.conversation.otherUser,l=Object(u.b)(),d=function(){var e=Object(K.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(z(t.otherUser.username));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){for(var t=e.conversation.messages,n=[],r=t.length-1;r>=0&&(t[r].senderId===o||t[r].readStatus||n.push(t[r]),t[r].senderId===o||!t[r].readStatus);)r--;c(n)}),[e.conversation,o]),Object(Ce.jsxs)(je.a,{onClick:function(){return d(e.conversation)},className:s.root,children:[Object(Ce.jsx)(it,{photoUrl:i.photoUrl,username:i.username,online:i.online,sidebar:!0}),Object(Ce.jsx)(ze,{conversation:e.conversation,unreadMessages:a})]})},ct=n(248),st=n(256),ot=Object(pe.a)((function(){return{profilePic:{height:44,width:44},badge:{height:13,width:13,borderRadius:"50%",border:"2px solid white",backgroundColor:"#D0DAE9"},online:{backgroundColor:"#1CED84"},sidebar:{marginLeft:17}}})),it=function(e){var t=ot(),n=e.sidebar,r=e.username,a=e.photoUrl,c=e.online;return Object(Ce.jsx)(je.a,{className:n?t.sidebar:"",children:Object(Ce.jsx)(ct.a,{classes:{badge:"".concat(t.badge," ").concat(c&&t.online)},variant:"dot",anchorOrigin:{horizontal:"right",vertical:"bottom"},overlap:"circle",children:Object(Ce.jsx)(st.a,{alt:r,src:a,className:t.profilePic})})})},ut=Object(pe.a)((function(){return{root:{display:"flex",flexDirection:"column",maxWidth:"60%",alignSelf:"flex-end",alignItems:"flex-end"},avatar:{height:"1rem",width:"1rem",marginRight:11,marginTop:6},date:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},text:{fontSize:14,color:"#91A3C0",letterSpacing:-.2,padding:8,fontWeight:"bold"},bubble:{background:"#F4F6FA",borderRadius:"10px 10px 0 10px"}}})),lt=function(e){var t=ut(),n=e.time,r=e.text,a=e.otherUser;return Object(Ce.jsxs)(je.a,{className:t.root,children:[Object(Ce.jsx)(me.a,{className:t.date,children:n}),Object(Ce.jsxs)(je.a,{children:[Object(Ce.jsx)(je.a,{className:t.bubble,children:Object(Ce.jsx)(me.a,{className:t.text,children:r})}),e.lastReadMessage===e.id&&Object(Ce.jsx)(st.a,{alt:a.username,src:a.photoUrl,className:t.avatar})]})]})},dt=Object(pe.a)((function(){return{root:{maxWidth:"60%",alignSelf:"flex-start",display:"flex"},avatar:{height:30,width:30,marginRight:11,marginTop:6},usernameDate:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},bubble:{backgroundImage:"linear-gradient(225deg, #6CC1FF 0%, #3A8DFF 100%)",borderRadius:"0 10px 10px 10px"},text:{fontSize:14,fontWeight:"bold",color:"#FFFFFF",letterSpacing:-.2,padding:8}}})),ft=function(e){var t=dt(),n=e.text,r=e.time,a=e.otherUser;return Object(Ce.jsxs)(je.a,{className:t.root,children:[Object(Ce.jsx)(st.a,{alt:a.username,src:a.photoUrl,className:t.avatar}),Object(Ce.jsxs)(je.a,{children:[Object(Ce.jsxs)(me.a,{className:t.usernameDate,children:[a.username," ",r]}),Object(Ce.jsx)(je.a,{className:t.bubble,children:Object(Ce.jsx)(me.a,{className:t.text,children:n})})]})]})},bt=Object(pe.a)((function(e){return{root:Object(fe.a)({display:"flex",flexGrow:8,flexDirection:"column",maxHeight:"100%"},e.breakpoints.up("md"),{width:"70%"}),chatHeader:{minHeight:"6rem"},chatContainer:Object(fe.a)({marginLeft:41,marginRight:41,display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"space-between",height:"80%"},e.breakpoints.down("sm"),{marginTop:"6rem"})}})),jt=function(){var e=bt(),t=Object(u.c)((function(e){return e.user})),n=Object(u.c)((function(e){return e.conversations})),r=Object(u.c)((function(e){return e.activeConversation})),a=n.find((function(e){return e.otherUser.username===r}))||{};return Object(Ce.jsx)(je.a,{className:e.root,children:a.otherUser&&Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsx)(xt,{className:e.chatHeader,username:a.otherUser.username,online:a.otherUser.online||!1}),Object(Ce.jsxs)(je.a,{className:e.chatContainer,children:[Object(Ce.jsx)(Ct,{messages:a.messages,otherUser:a.otherUser,userId:t.id}),Object(Ce.jsx)(pt,{otherUser:a.otherUser,conversationId:a.id,user:t})]})]})})},mt=Object(pe.a)((function(e){return{root:{justifySelf:"flex-end",marginTop:15},input:{height:70,backgroundColor:"#F4F6FA",borderRadius:8,marginBottom:20}}})),pt=function(e){var t=Object(u.c)((function(e){return e.user})),n=Object(r.useState)(""),a=Object(J.a)(n,2),c=a[0],s=a[1],o=Object(u.b)(),i=mt(),l=function(){var n=Object(K.a)($.a.mark((function n(r){var a;return $.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.preventDefault(),0!==r.target.text.value.trim().length){n.next=4;break}return n.abrupt("return");case 4:return a={text:r.target.text.value,recipientId:e.otherUser.id,conversationId:e.conversationId,sender:e.conversationId?null:t},n.next=7,o(le(a));case 7:s("");case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(Ce.jsx)("form",{className:i.root,onSubmit:l,children:Object(Ce.jsx)(Te.a,{fullWidth:!0,hiddenLabel:!0,children:Object(Ce.jsx)(Je.a,{classes:{root:i.input},disableUnderline:!0,placeholder:"Type something...",value:c,onChange:function(e){s(e.target.value)},name:"text"})})})},ht=n(65),gt=Object(pe.a)((function(e){return{root:Object(fe.a)({display:"flex",alignItems:"center",justifyContent:"space-between",height:89,marginBottom:"2rem",boxShadow:"0 2px 20px 0 rgba(88,133,196,0.10)"},e.breakpoints.down("sm"),{position:"fixed",zIndex:"10",background:"white",width:"100%"}),content:{display:"flex",alignItems:"center",marginLeft:24},username:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginRight:14},statusText:{fontSize:12,color:"#BFC9DB",letterSpacing:-.17},statusDot:{height:8,width:8,borderRadius:"50%",marginRight:5,backgroundColor:"#D0DAE9"},online:{background:"#1CED84"},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}})),xt=function(e){var t=gt(),n=e.username,a=e.online,c=Object(u.b)(),s=Object(r.useState)(!1),o=Object(J.a)(s,2),i=o[0],l=o[1],d=Object(r.useState)(!1),f=Object(J.a)(d,2),b=f[0],j=f[1];return Object(Ce.jsxs)(je.a,{className:t.root,children:[Object(Ce.jsxs)(je.a,{className:t.content,children:[Object(Ce.jsx)(me.a,{className:t.username,children:n}),Object(Ce.jsx)(je.a,{className:"".concat(t.statusDot," ").concat(t[a&&"online"])}),Object(Ce.jsx)(me.a,{className:t.statusText,children:a?"Online":"Offline"})]}),ht.isMobile&&Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsx)(ke.a,{className:t.menuButton,onClick:function(e){j(e.currentTarget),l(!0)},children:Object(Ce.jsx)(Ve.a,{className:t.ellipsis})}),Object(Ce.jsx)(_e.a,{anchorEl:b,open:i,onClose:function(){l((function(e){return!e}))},children:Object(Ce.jsx)(Ge.a,{onClick:function(e){c(z(""))},children:"All Chats"})})]})]})},Ot=n(126),vt=n.n(Ot),wt=Object(pe.a)((function(e){return{root:{overflowY:"auto",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},display:"flex",flexDirection:"column"}}})),Ct=function(e){var t=Object(r.useState)(),n=Object(J.a)(t,2),a=n[0],c=n[1],s=e.messages,o=e.otherUser,i=e.userId,l=Object(r.useRef)(),d=wt(),f=Object(u.b)();return Object(r.useEffect)((function(){l.current.scrollIntoView({smooth:!0}),f(function(e,t,n){return function(){var r=Object(K.a)($.a.mark((function r(a){var c,s,o;return $.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c=[],s=e.length-1;case 2:if(!(s>=0)){r.next=9;break}if(e[s].senderId===t||e[s].readStatus||(c.push(e[s].id),e[s].readStatus=!0),e[s].senderId===t||!e[s].readStatus){r.next=6;break}return r.abrupt("break",9);case 6:s--,r.next=2;break;case 9:if(o={unreadMessageIds:c},!(c.length>0)){r.next=21;break}return r.prev=11,r.next=14,ee.a.patch("/api/messages",{data:o});case 14:a(B(e)),ae.emit("read-messages",{messages:e,to:n}),r.next=21;break;case 18:r.prev=18,r.t0=r.catch(11),console.log(r.t0);case 21:case"end":return r.stop()}}),r,null,[[11,18]])})));return function(e){return r.apply(this,arguments)}}()}(s,i,o.id))})),Object(r.useEffect)((function(){for(var e=s.length-1;e>=0;e--)if(s[e].senderId===i&&s[e].readStatus){c(s[e].id);break}}),[s,i,c,a]),Object(Ce.jsxs)(je.a,{className:d.root,children:[s.map((function(e,t){var n=vt()(e.createdAt).format("h:mm");return e.senderId===i?Object(Ce.jsx)(lt,{id:e.id,text:e.text,time:n,lastReadMessage:a,otherUser:o},e.id):Object(Ce.jsx)(ft,{text:e.text,time:n,otherUser:o},e.id)})),Object(Ce.jsx)("div",{ref:l})]})},yt=Object(pe.a)((function(e){return{root:Object(fe.a)({height:"97vh"},e.breakpoints.up("sm"),{flexWrap:"nowrap"}),mobileContainer:{width:"100vw"}}})),St=function(e){var t=Object(u.c)((function(e){return e.activeConversation})),n=Object(u.c)((function(e){return e.user})),a=yt(),c=Object(u.b)(),s=Object(X.g)();return n.id||s.push("/register"),Object(r.useEffect)((function(){}),[t]),Object(r.useEffect)((function(){ae.connected||ae.connect()}),[]),Object(r.useEffect)((function(){c(function(){var e=Object(K.a)($.a.mark((function e(t){var n,r;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ee.a.get("/api/conversations");case 3:n=e.sent,r=n.data,t({type:F,conversations:r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())}),[c]),Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsx)(ht.BrowserView,{children:Object(Ce.jsxs)(be.a,{container:!0,component:"main",className:a.root,children:[Object(Ce.jsx)(Be.a,{}),Object(Ce.jsx)(nt,{}),Object(Ce.jsx)(jt,{})]})}),Object(Ce.jsx)(ht.MobileView,{className:a.mobileContainer,children:Object(Ce.jsxs)(be.a,{container:!0,component:"main",className:a.root,children:[Object(Ce.jsx)(Be.a,{}),!t&&Object(Ce.jsx)(nt,{}),Object(Ce.jsx)(jt,{})]})})]})},kt=n(254),Et=n(127),Ft=n.n(Et),Nt=Object(pe.a)((function(e){return{snackbar:{backgroundColor:"red",fontWeight:"bold"},icon:{color:"white"}}})),It=function(e){var t=Nt();return Object(Ce.jsx)(kt.a,{open:e.snackBarOpen,onClose:function(){return e.setSnackBarOpen(!1)},message:e.errorMessage||"Sorry, an error occured. Please try again",action:Object(Ce.jsx)(a.a.Fragment,{children:Object(Ce.jsx)(ke.a,{className:t.icon,size:"small",onClick:function(){return e.setSnackBarOpen(!1)},children:Object(Ce.jsx)(Ft.a,{color:"secondary"})})}),ContentProps:{classes:{root:t.snackbar}}})},Tt=Object(X.i)((function(e){var t=Object(r.useState)(""),n=Object(J.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(!1),o=Object(J.a)(s,2),i=o[0],l=o[1],d=Object(u.c)((function(e){return e.user})),f=Object(u.b)();return Object(r.useEffect)((function(){f(function(){var e=Object(K.a)($.a.mark((function e(t){var n,r;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(g(!0)),e.prev=1,e.next=4,ee.a.get("/auth/user");case 4:n=e.sent,r=n.data,t(h(r)),r.id&&ae.emit("go-online",r.id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:return e.prev=13,t(g(!1)),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])})));return function(t){return e.apply(this,arguments)}}())}),[f]),Object(r.useEffect)((function(){d.error&&("string"===typeof d.error?c(d.error):c("Internal Server Error. Please try again"),l(!0))}),[d.error]),d.isFetchingUser?Object(Ce.jsx)("div",{children:"Loading..."}):Object(Ce.jsxs)(Ce.Fragment,{children:[i&&Object(Ce.jsx)(It,{setSnackBarOpen:l,errorMessage:a,snackBarOpen:i}),Object(Ce.jsxs)(X.d,{children:[Object(Ce.jsx)(X.b,{path:"/login",component:Me}),Object(Ce.jsx)(X.b,{path:"/register",component:Me}),Object(Ce.jsx)(X.b,{exact:!0,path:"/",render:function(e){var t;return(null===(t=e.user)||void 0===t?void 0:t.id)?Object(Ce.jsx)(St,{}):Object(Ce.jsx)(Me,{})}}),Object(Ce.jsx)(X.b,{path:"/home",component:St})]})]})}));var Ut=function(){return Object(Ce.jsx)(u.a,{store:V,children:Object(Ce.jsx)(o.a,{theme:q,children:Object(Ce.jsx)(i.a,{children:Object(Ce.jsx)(Tt,{})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(Ce.jsx)(Ut,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[207,1,2]]]);
//# sourceMappingURL=main.3bffaab8.chunk.js.map